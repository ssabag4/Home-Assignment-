This is update code with minor bug fix
